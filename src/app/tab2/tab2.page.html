<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>
      Obchod
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-card class="energy-card">
    <ion-card-content>
      <div class="energy-info">
        <ion-icon name="flash" color="warning"></ion-icon>
        <div>
          <h2>{{ formatNumber(gameState.energy || 0) }}</h2>
          <p>Dostupná energie</p>
        </div>
      </div>
    </ion-card-content>
  </ion-card>

  <ion-segment 
    [value]="selectedSegment" 
    (ionChange)="segmentChanged($event)"
    color="primary">
    <ion-segment-button value="click">
      <ion-label>Klikání</ion-label>
      <ion-icon name="finger-print"></ion-icon>
    </ion-segment-button>
    <ion-segment-button value="passive">
      <ion-label>Pasivní</ion-label>
      <ion-icon name="time"></ion-icon>
    </ion-segment-button>
  </ion-segment>

  <div *ngIf="selectedSegment === 'click'" class="upgrades-container">
    <ion-card *ngFor="let upgrade of clickUpgrades" class="upgrade-card">
      <ion-card-content>
        <div class="upgrade-info">
          <div class="upgrade-icon">
            <ion-icon [name]="upgrade.icon" color="primary"></ion-icon>
            <ion-badge *ngIf="upgrade.level > 0" color="success">{{ upgrade.level }}</ion-badge>
          </div>
          <div class="upgrade-details">
            <h3>{{ upgrade.name }}</h3>
            <p>{{ upgrade.description }}</p>
            <div class="upgrade-stats">
              <ion-chip color="primary" outline="true">
                <ion-icon name="arrow-up"></ion-icon>
                <ion-label>+{{ upgrade.effect }} / klik</ion-label>
              </ion-chip>
            </div>
          </div>
        </div>
        <ion-button 
          expand="block" 
          [disabled]="!canAfford(upgrade)"
          (click)="buyUpgrade(upgrade.id)"
          [color]="canAfford(upgrade) ? 'success' : 'medium'">
          <ion-icon name="flash" slot="start"></ion-icon>
          {{ formatNumber(upgrade.currentCost) }}
        </ion-button>
      </ion-card-content>
    </ion-card>
  </div>

  <div *ngIf="selectedSegment === 'passive'" class="upgrades-container">
    <ion-card *ngFor="let upgrade of passiveUpgrades" class="upgrade-card">
      <ion-card-content>
        <div class="upgrade-info">
          <div class="upgrade-icon">
            <ion-icon [name]="upgrade.icon" color="secondary"></ion-icon>
            <ion-badge *ngIf="upgrade.level > 0" color="success">{{ upgrade.level }}</ion-badge>
          </div>
          <div class="upgrade-details">
            <h3>{{ upgrade.name }}</h3>
            <p>{{ upgrade.description }}</p>
            <div class="upgrade-stats">
              <ion-chip color="secondary" outline="true">
                <ion-icon name="arrow-up"></ion-icon>
                <ion-label>+{{ upgrade.effect }} / s</ion-label>
              </ion-chip>
            </div>
          </div>
        </div>
        <ion-button 
          expand="block" 
          [disabled]="!canAfford(upgrade)"
          (click)="buyUpgrade(upgrade.id)"
          [color]="canAfford(upgrade) ? 'success' : 'medium'">
          <ion-icon name="flash" slot="start"></ion-icon>
          {{ formatNumber(upgrade.currentCost) }}
        </ion-button>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>